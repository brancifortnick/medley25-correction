{"ast":null,"code":"const GET_MUSICIANS = \"musician/GET_MUSICIANS\";\nconst GET_ONE = \"musician/GET_ONE\";\nconst ADD_MUSICIAN = \"musician/ADD_MUSICIAN\";\nconst DELETE_MUSICIAN = \"musician/DELETE_MUSICIAN\";\nconst UPDATE_BIOGRAPHY = \"musician/UPDATE_BIOGRAPHY\";\n// const ADD_IMAGE = \"musician/ADD_IMAGE\"; -- put route for image updating\n\nconst getAllArtists = musicians => ({\n  type: GET_MUSICIANS,\n  payload: musicians\n});\nconst getOne = musician => ({\n  type: GET_ONE,\n  payload: musician\n});\nconst addMusician = musician => ({\n  type: ADD_MUSICIAN,\n  payload: musician\n});\nconst deleteMusician = musician => ({\n  type: DELETE_MUSICIAN,\n  payload: musician\n});\nconst updateBio = musician => ({\n  type: UPDATE_BIOGRAPHY,\n  payload: musician\n});\n\n// const addImage = (musician) => ({\n//   type: ADD_IMAGE,\n//   payload: musician,\n// });\n//---put route\n\nexport const getAllMusicians = id => async dispatch => {\n  const res = await fetch(`/api/musicians/`);\n  if (res.ok) {\n    const data = await res.json();\n    dispatch(getAllArtists(data.musicians));\n    return data;\n  }\n};\nexport const postNewMusician = (profile_img, biography, userId, musician_name) => {\n  return async dispatch => {\n    try {\n      // Step 1: Upload image\n      const formData = new FormData();\n      formData.append(\"profile_img\", profile_img);\n      const imageRes = await fetch(\"/api/musicians/new-picture\", {\n        method: \"POST\",\n        body: formData // ✅ No headers here!\n      });\n      if (!imageRes.ok) {\n        console.log(\"Image upload failed\");\n        return;\n      }\n      const imageData = await imageRes.json();\n      const profileImgUrl = imageData.url;\n\n      // Step 2: Create musician with uploaded image URL\n      const musicianData = new FormData();\n      musicianData.append(\"profile_img\", profileImgUrl);\n      musicianData.append(\"biography\", biography);\n      musicianData.append(\"user_id\", userId);\n      musicianData.append(\"musician_name\", musician_name);\n      const musicianRes = await fetch(\"/api/musicians/\", {\n        method: \"POST\",\n        body: musicianData\n      });\n      if (musicianRes.ok) {\n        const newMusician = await musicianRes.json();\n        dispatch(addMusician(newMusician));\n        return newMusician;\n      } else {\n        console.log(\"Musician creation failed\");\n        return;\n      }\n    } catch (error) {\n      console.log(\"Error creating musician:\", error);\n      return;\n    }\n  };\n};\nexport const addingFullMusician = (profile_img, biography, userId, musician_name) => {\n  return dispatch => {\n    if (profile_img && biography && userId && musician_name) {\n      return dispatch(postNewMusician(profile_img, biography, Number(userId), musician_name));\n    } else {\n      console.log(\"error missing params\");\n      return;\n    }\n  };\n};\nexport const getOneMusician = id => async dispatch => {\n  const res = await fetch(`/api/musicians/${id}`);\n  if (res.ok) {\n    const data = await res.json();\n    dispatch(getOne(data));\n  } //\n};\nexport const deleteOneMusician = id => async dispatch => {\n  const res = await fetch(`/api/musicians/${id}`, {\n    method: \"DELETE\"\n  });\n  if (res.ok) {\n    dispatch(deleteMusician(id));\n  } else {\n    console.log(\"Musician Can't be deleted\");\n  }\n};\nexport const updateBiography = (formData, musicianId) => async dispatch => {\n  const response = await fetch(`/api/musicians/${musicianId}/biography`, {\n    method: \"PUT\",\n    body: formData\n  });\n  if (response.ok) {\n    const biography = await response.json();\n    dispatch(updateBio(biography));\n  }\n};\n\n// export const uploadImageToS = (profile_img, musicianId) => async (dispatch) => {\n//   // profile_img = profile_img.url\n//   const response = await fetch(`/api/musicians/${musicianId}/image`, {\n//     method: \"PUT\",\n//     headers: {\n//       \"Content-Type\": \"application/json\",\n//     },\n//     body: JSON.stringify({ profile_img, musicianId }),\n//   });\n//   if (response.ok) {\n//     const picture = await response.json();\n//     dispatch(addImage(picture));\n//   } else {\n//     console.log(\"Image can't be added\");\n//   }\n// };\n//---put route semi functioning\n\nconst initialState = {};\nexport default function reducer() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  switch (action.type) {\n    case GET_MUSICIANS:\n      let newState = {};\n      action.payload.forEach(musician => {\n        newState[musician.id] = musician;\n      });\n      return newState;\n    case ADD_MUSICIAN:\n      const addState = {\n        ...state\n      };\n      addState[action.payload.id] = action.payload;\n      return addState;\n    // return { ...action.payload };\n    case GET_ONE:\n      return {\n        ...action.payload\n      };\n    case DELETE_MUSICIAN:\n      const currentState = {\n        ...state\n      };\n      delete currentState[action.payload.id];\n      return currentState;\n    case UPDATE_BIOGRAPHY:\n      return {\n        ...action.payload\n      };\n    default:\n      return state;\n  }\n}","map":{"version":3,"names":["GET_MUSICIANS","GET_ONE","ADD_MUSICIAN","DELETE_MUSICIAN","UPDATE_BIOGRAPHY","getAllArtists","musicians","type","payload","getOne","musician","addMusician","deleteMusician","updateBio","getAllMusicians","id","dispatch","res","fetch","ok","data","json","postNewMusician","profile_img","biography","userId","musician_name","formData","FormData","append","imageRes","method","body","console","log","imageData","profileImgUrl","url","musicianData","musicianRes","newMusician","error","addingFullMusician","Number","getOneMusician","deleteOneMusician","updateBiography","musicianId","response","initialState","reducer","state","arguments","length","undefined","action","newState","forEach","addState","currentState"],"sources":["/home/nicholas/med/medley-sesh/react-app/src/store/musician.js"],"sourcesContent":["const GET_MUSICIANS = \"musician/GET_MUSICIANS\";\r\nconst GET_ONE = \"musician/GET_ONE\";\r\nconst ADD_MUSICIAN = \"musician/ADD_MUSICIAN\";\r\nconst DELETE_MUSICIAN = \"musician/DELETE_MUSICIAN\";\r\nconst UPDATE_BIOGRAPHY = \"musician/UPDATE_BIOGRAPHY\";\r\n// const ADD_IMAGE = \"musician/ADD_IMAGE\"; -- put route for image updating\r\n\r\nconst getAllArtists = (musicians) => ({\r\n  type: GET_MUSICIANS,\r\n  payload: musicians,\r\n});\r\n\r\nconst getOne = (musician) => ({\r\n  type: GET_ONE,\r\n  payload: musician,\r\n});\r\n\r\nconst addMusician = (musician) => ({\r\n  type: ADD_MUSICIAN,\r\n  payload: musician,\r\n});\r\n\r\nconst deleteMusician = (musician) => ({\r\n  type: DELETE_MUSICIAN,\r\n  payload: musician,\r\n});\r\n\r\nconst updateBio = (musician) => ({\r\n  type: UPDATE_BIOGRAPHY,\r\n  payload: musician,\r\n});\r\n\r\n// const addImage = (musician) => ({\r\n//   type: ADD_IMAGE,\r\n//   payload: musician,\r\n// });\r\n//---put route\r\n\r\nexport const getAllMusicians = (id) => async (dispatch) => {\r\n  const res = await fetch(`/api/musicians/`);\r\n  if (res.ok) {\r\n    const data = await res.json();\r\n    dispatch(getAllArtists(data.musicians));\r\n    return data;\r\n  }\r\n};\r\n\r\nexport const postNewMusician = (profile_img, biography, userId, musician_name) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      // Step 1: Upload image\r\n      const formData = new FormData();\r\n      formData.append(\"profile_img\", profile_img);\r\n\r\n      const imageRes = await fetch(\"/api/musicians/new-picture\", {\r\n        method: \"POST\",\r\n        body: formData, // ✅ No headers here!\r\n      });\r\n\r\n      if (!imageRes.ok) {\r\n        console.log(\"Image upload failed\");\r\n        return;\r\n      }\r\n\r\n      const imageData = await imageRes.json();\r\n      const profileImgUrl = imageData.url;\r\n\r\n      // Step 2: Create musician with uploaded image URL\r\n      const musicianData = new FormData();\r\n      musicianData.append(\"profile_img\", profileImgUrl);\r\n      musicianData.append(\"biography\", biography);\r\n      musicianData.append(\"user_id\", userId);\r\n      musicianData.append(\"musician_name\", musician_name);\r\n\r\n      const musicianRes = await fetch(\"/api/musicians/\", {\r\n        method: \"POST\",\r\n        body: musicianData,\r\n      });\r\n\r\n      if (musicianRes.ok) {\r\n        const newMusician = await musicianRes.json();\r\n        dispatch(addMusician(newMusician));\r\n        return newMusician;\r\n      } else {\r\n        console.log(\"Musician creation failed\");\r\n        return;\r\n      }\r\n    } catch (error) {\r\n      console.log(\"Error creating musician:\", error);\r\n      return;\r\n    }\r\n  };\r\n};\r\n\r\nexport const addingFullMusician = (profile_img, biography, userId, musician_name) => {\r\n  return (dispatch) => {\r\n    if (profile_img && biography && userId && musician_name) {\r\n      return dispatch(\r\n        postNewMusician(profile_img, biography, Number(userId), musician_name)\r\n      );\r\n    } else {\r\n      console.log(\"error missing params\");\r\n      return;\r\n    }\r\n  };\r\n};\r\n\r\n\r\nexport const getOneMusician = (id) => async (dispatch) => {\r\n  const res = await fetch(`/api/musicians/${id}`);\r\n  if (res.ok) {\r\n    const data = await res.json();\r\n    dispatch(getOne(data));\r\n  } //\r\n};\r\n\r\nexport const deleteOneMusician = (id) => async (dispatch) => {\r\n  const res = await fetch(`/api/musicians/${id}`, {\r\n    method: \"DELETE\",\r\n  });\r\n  if (res.ok) {\r\n    dispatch(deleteMusician(id));\r\n  } else {\r\n    console.log(\"Musician Can't be deleted\");\r\n  }\r\n};\r\n\r\nexport const updateBiography = (formData, musicianId) => async (dispatch) => {\r\n  const response = await fetch(`/api/musicians/${musicianId}/biography`, {\r\n    method: \"PUT\",\r\n    body: formData,\r\n  });\r\n  if (response.ok) {\r\n    const biography = await response.json();\r\n    dispatch(updateBio(biography));\r\n  }\r\n};\r\n\r\n// export const uploadImageToS = (profile_img, musicianId) => async (dispatch) => {\r\n//   // profile_img = profile_img.url\r\n//   const response = await fetch(`/api/musicians/${musicianId}/image`, {\r\n//     method: \"PUT\",\r\n//     headers: {\r\n//       \"Content-Type\": \"application/json\",\r\n//     },\r\n//     body: JSON.stringify({ profile_img, musicianId }),\r\n//   });\r\n//   if (response.ok) {\r\n//     const picture = await response.json();\r\n//     dispatch(addImage(picture));\r\n//   } else {\r\n//     console.log(\"Image can't be added\");\r\n//   }\r\n// };\r\n//---put route semi functioning\r\n\r\nconst initialState = {};\r\n\r\nexport default function reducer(state = initialState, action) {\r\n  switch (action.type) {\r\n    case GET_MUSICIANS:\r\n      let newState = {};\r\n      action.payload.forEach((musician) => {\r\n        newState[musician.id] = musician;\r\n      });\r\n      return newState;\r\n    case ADD_MUSICIAN:\r\n      const addState = { ...state };\r\n      addState[action.payload.id] = action.payload;\r\n      return addState;\r\n    // return { ...action.payload };\r\n    case GET_ONE:\r\n      return { ...action.payload };\r\n    case DELETE_MUSICIAN:\r\n      const currentState = { ...state };\r\n      delete currentState[action.payload.id];\r\n      return currentState;\r\n    case UPDATE_BIOGRAPHY:\r\n      return { ...action.payload };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}